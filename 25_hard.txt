Условие сложной задачи

Пусть M – сумма минимального и максимального натуральных делителей целого числа, не считая единицы и самого числа. R – целая часть среднего арифметического всех нечётных натуральных делителей числа, не считая единицы и самого числа. Если таких делителей у числа нет, то считаем значения M и R равным нулю. Напишите программу, которая перебирает целые числа, бо́льшие 500 000, в порядке возрастания и ищет среди них такие, для которых произведение М и R будет полным квадратом натурального числа. В ответе запишите в первом столбце таблицы первые пять найденных чисел в порядке возрастания, а во втором столбце – соответствующие им произведения M на R.

Ответ:
530543 386358336
638759 921729600
682051 148352400
689206 20416123225
822103 585059344
